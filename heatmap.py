import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from matplotlib.colors import ListedColormap

# Beta and Gamma angles
beta = [-90, -75, -60, -45, -30, -15, 0, 15, 30, 45, 60, 75, 90]
gamma = [-90, -75, -60, -45, -30, -15, 0, 15, 30, 45, 60, 75, 90]

# ax matrix 
ax = np.array([
    [-0.09093, 0.1671, 0.0873, 0.0098, -0.2994, 0, 0, 0, 1.2941, 1.0146, 0.9838, 0.9619, -0.1478],
    [-0.3417, 0.0475, 0.0078, 0.3167, -0.1473, 0, 0, 0, 0.7733, 1.6392, 1.1441, 1.2528, 0.4356],
    [-0.9111, -0.4965, -0.1151, 0.0064, 0.1262, 0, 0, 0, 0.907, 1.4171, 1.5348, 1.2276, 0.6032],
    [0.0788, -0.8872, -0.5739, -0.1268, -0.0853, 0, 0, 0, 1.0344, 1.3693, 1.5521, 1.1666, 0.5937],
    [0.0799, 0.0993, -0.7632, -0.695, 0.2864, 0, 0, 0, 0.9539, 1.2875, 1.0272, 1.3105, 0.4382],
    [0.2649, 0.0773, -0.2217, -0.7118, 0.5112, 0, 0, 0, 0.7764, 1.094, 1.3137, 0.3909, 0.4921],
    [-0.0081, -0.2029, -0.0039, -0.6672, 0.4715, 0, 0, 0, 0.8285, 1.01, 0.7879, 0.5705, -0.2422],
    [-0.2649, -0.0156, -0.3924, -0.0882, -0.0793, 0, 0, 0, 0.5046, 0.8272, 0.5789, 0.2742, -0.4921],
    [-0.0799, -0.624, -0.0438, -0.4189, -0.0657, 0, 0, 0, 0.3928, 0.5283, 0.3637, 0.0552, -0.4382],
    [-0.0788, -0.1488, -0.8144, -0.113, -0.2691, 0, 0, 0, 0.5415, 0.5939, 0.2794, -0.0061, -0.5937],
    [0.9111, 0.0915, -0.2414, -0.7269, -0.0566, 0, 0, 0, 0.8222, 0.8403, 0.524, -0.0787, -0.6032],
    [0.3417, 0.4168, 0.0255, -0.2426, -0.678, 0, 0, 0, 1.103, 1.0606, 0.9039, 0.1202, -0.4356],
    [-0.09093, 0.1671, 0.0873, 0.0098, -0.2994, 0, 0, 0, 1.2941, 1.0146, 0.9838, 0.9619, -0.1478]
]) / 12

# ay matrix 
ay = np.array([
    [-0.1346, -0.1136, -0.0849, -0.1006, 0.0026, 0, 0, 0, -0.51, -0.5789, -0.9666, -1.8677, -1.3084],
    [-0.052, -0.1103, -0.1386, -0.2084, -0.0804, 0, 0, 0, -0.1966, -1.1841, -1.24, -2.3293, -2.0815],
    [0.1468, 0.0234, -0.3911, -0.1235, -0.2004, 0, 0, 0, -0.794, -1.203, -1.9337, -2.4324, -2.8374],
    [-0.0297, 0.3858, 0.1536, -0.0682, -0.1527, 0, 0, 0, -1.0481, -1.7964, -2.1793, -2.8013, -3.0851],
    [-0.0787, -0.052, 0.6183, 0.4667, -0.0259, 0, 0, 0, -1.1648, -1.8582, -2.4113, -3.275, -3.1554],
    [-0.1675, -0.0583, 0.0733, 0.736, 0.5384, 0, 0, 0, -1.1937, -1.8645, -3.3166, -2.784, -3.8658],
    [-0.0025, -0.1456, -0.1622, 0.3217, 0.5309, 0, 0, 0, -1.2083, -1.7793, -2.3312, -4.7097, -3.0321],
    [-0.1675, -0.0857, -0.2079, -0.1156, -0.0714, 0, 0, 0, -0.9384, -1.7791, -2.1776, -2.921, -3.8658],
    [-0.0787, -0.1906, -0.1296, -0.1726, -0.0384, 0, 0, 0, -0.3731, -1.2544, -1.9952, -2.5172, -3.1554],
    [-0.0297, -0.1128, -0.1908, -0.1376, -0.0237, 0, 0, 0, -0.1008, -0.8457, -1.3566, -2.076, -3.0851],
    [0.1468, -0.0929, -0.1688, -0.0922, -0.024, 0, 0, 0, -0.1047, -0.474, -1.2913, -1.4279, -2.8374],
    [-0.0525, -0.0363, -0.0886, -0.1208, 0.1095, 0, 0, 0, -0.322, -0.5291, -0.9606, -1.0411, -2.0815],
    [-0.1346, -0.1136, -0.0849, -0.1006, 0.0026, 0, 0, 0, -0.51, -0.5789, -0.9666, -1.8677, -1.3084]
]) / -12

ax[ax == 0.0] = np.nan
ay[ay == 0.0] = np.nan

def plot_heatmap(data, title, vmin, vmax):
    plt.figure(figsize=(10, 8))
    sns.heatmap(
        data,
        xticklabels=gamma,
        yticklabels=beta,
        cmap='turbo',
        vmin=vmin,
        vmax=vmax,
        linewidths=0.5,
        annot=True,
        fmt=".3f",
        cbar_kws={'label': title},
        mask=np.isnan(data)
    )
    plt.xlabel("Gamma (°)")
    plt.ylabel("Beta (°)")
    plt.title(title)
    plt.gca().invert_yaxis()
    plt.tight_layout()
    plt.show()

plot_heatmap(ax, r'$\alpha_x$ (N/cm³)', vmin=-0.2, vmax=0.2)
plot_heatmap(ay, r'$\alpha_z$ (N/cm³)', vmin=-0.4, vmax=0.4)
